(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{373:function(e,t,a){"use strict";a.r(t);var r=a(32),n=Object(r.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"kc-agent-monitoring-via-cln-portal"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kc-agent-monitoring-via-cln-portal","aria-hidden":"true"}},[e._v("#")]),e._v(" KC agent monitoring via CLN Portal")]),e._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#built-in-monitoring"}},[e._v("Built-in monitoring")])]),a("li",[a("a",{attrs:{href:"#kernelcare-monitoring-api"}},[e._v("KernelCare monitoring API")])]),a("li",[a("a",{attrs:{href:"#zabbix-template"}},[e._v("Zabbix Template")])]),a("li",[a("a",{attrs:{href:"#datadog-integration"}},[e._v("Datadog Integration")])])])]),a("p"),e._v(" "),a("h2",{attrs:{id:"built-in-monitoring"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#built-in-monitoring","aria-hidden":"true"}},[e._v("#")]),e._v(" Built-in monitoring")]),e._v(" "),a("p",[e._v("Systems protected by KernelCare can be monitored by means of CloudLinux Network (CLN) portal available at "),a("a",{attrs:{href:"https://cln.cloudlinux.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://cln.cloudlinux.com"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("Click "),a("em",[e._v("KernelCare activation key")]),e._v(" to see the list of servers activated with it. Servers marked with exclamation mark do not have the latest KernelCare patches installed.")]),e._v(" "),a("p",[a("img",{attrs:{src:"/images/kckeymonit_zoom70.png",alt:""}})]),e._v(" "),a("h2",{attrs:{id:"kernelcare-monitoring-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kernelcare-monitoring-api","aria-hidden":"true"}},[e._v("#")]),e._v(" KernelCare monitoring API")]),e._v(" "),a("p",[e._v("It is possible to integrate KernelCare status monitoring with any third-party monitoring system that supports REST API.")]),e._v(" "),a("ul",[a("li",[e._v("The query syntax for key-based licenses is: "),a("code",[e._v("https://cln.cloudlinux.com/api/kcare/nagios/{key_id}")])]),e._v(" "),a("li",[e._v("The query syntax for IP-based licenses (resellers) is: "),a("code",[e._v("https://cln.cloudlinux.com/api/kcare/nagios-res/{login}/{token}")])])]),e._v(" "),a("p",[e._v("The latest CloudLinux REST API description is available at "),a("a",{attrs:{href:"https://cln.cloudlinux.com/clweb/downloads/cloudlinux-rest-api.pdf",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://cln.cloudlinux.com/clweb/downloads/cloudlinux-rest-api.pdf"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"zabbix-template"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zabbix-template","aria-hidden":"true"}},[e._v("#")]),e._v(" Zabbix Template")]),e._v(" "),a("p",[e._v("Zabbix Template for KernelCare")]),e._v(" "),a("p",[a("code",[e._v("check_kcare")]),e._v(" is a Nagios/Zabbix plugin that provides a way to monitor the out of date and inactive servers. It can provide information on servers assigned to the KernelCare key, or for all the servers in partner account.")]),e._v(" "),a("p",[e._v("You can download the plugin from "),a("a",{attrs:{href:"https://patches.kernelcare.com/downloads/nagios/check_kcare",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://patches.kernelcare.com/downloads/nagios/check_kcare"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("/usr/lib/zabbix/externalscripts")]),e._v(" "),a("p",[e._v("(or any other directory configured for Zabbix external check scripts)")]),e._v(" "),a("p",[e._v("Script options:")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th"),e._v(" "),a("th")])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("code",[e._v("-z")])]),e._v(" "),a("td",[e._v("Zabbix compatible format (Nagios otherwise)")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("-k KERNELCARE_KEY")])]),e._v(" "),a("td",[e._v("retrieve status for servers associated with KEY")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("-l PARTNER_LOGIN --api-token TOKEN")])]),e._v(" "),a("td",[e._v("retrieve status for all servers in partner account based on login/token")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("-c o,u,i -- return CRITICAL")])]),e._v(" "),a("td",[e._v("list of coma separate o, u & i."),a("br"),a("code",[e._v("o")]),e._v(" -out of date"),a("br"),a("code",[e._v("u")]),e._v(" - unknown kernel"),a("br"),a("code",[e._v("i")]),e._v(" - inactive server")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("-w o,u,i -- return WARNING")])]),e._v(" "),a("td",[e._v("list of coma separate o, u & i."),a("br"),a("code",[e._v("o")]),e._v(" - out of date"),a("br"),a("code",[e._v("u")]),e._v(" - unknown kernel"),a("br"),a("code",[e._v("i")]),e._v(" - inactive server")])])])]),e._v(" "),a("p",[e._v("You can download Zabbix template at:")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://patches.kernelcare.com/downloads/nagios/kcare_zabbix_template.xml",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://patches.kernelcare.com/downloads/nagios/kcare_zabbix_template.xml"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"datadog-integration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#datadog-integration","aria-hidden":"true"}},[e._v("#")]),e._v(" Datadog Integration")]),e._v(" "),a("p",[e._v("You can monitor out-of-date and inactive KernelCare agents with the help of DataDog integration. It can provide information on servers assigned to a KernelCare key or for all servers in a partner CLN account.")]),e._v(" "),a("p",[e._v("The intergration is installed with Datadog Agent (Agent-based integration)\n"),a("a",{attrs:{href:"https://docs.datadoghq.com/getting_started/integrations/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://docs.datadoghq.com/getting_started/integrations/"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("The integration is available from the official datadog github repository\n"),a("a",{attrs:{href:"https://github.com/DataDog/integrations-extras/tree/master/kernelcare",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/DataDog/integrations-extras/tree/master/kernelcare"),a("OutboundLink")],1)]),e._v(" "),a("h4",{attrs:{id:"installation-on-a-system-that-has-datadog-agent-installed"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation-on-a-system-that-has-datadog-agent-installed","aria-hidden":"true"}},[e._v("#")]),e._v(" Installation on a system that has DataDog Agent installed.")]),e._v(" "),a("p",[e._v("CentOS 8 (or other EL8-based):")]),e._v(" "),a("p",[e._v("Install required yum packages and prepare build environment.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('yum -y install python3 python3-devel gcc git\npython3 -m venv /tmp/python3-env\n. /tmp/python3-env/bin/activate\npip3 install "datadog-checks-dev[cli]"\nmkdir $HOME/dd/\ncd $HOME/dd/\ngit clone https://github.com/DataDog/integrations-extras.git\nddev config set repo extras\n')])])]),a("p",[e._v("Build python wheel package.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ddev -e release build kernelcare\n")])])]),a("p",[e._v("Install python wheel package to "),a("code",[e._v("datadog-agent")]),e._v(".")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cp /root/dd/integrations-extras/kernelcare/dist/datadog_kernelcare*.whl /tmp/.\nsudo -u dd-agent datadog-agent integration install -w /tmp/datadog_kernelcare*.whl\n")])])]),a("p",[e._v("Move configuration file.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("mv /etc/datadog-agent/conf.d/kernelcare.d/conf.yaml.example /etc/datadog-agent/conf.d/kernelcare.d/conf.yaml\n")])])]),a("p",[e._v("In the configureation file you need to specify the "),a("code",[e._v("key")]),e._v(" parameter - the KernelCare activation key. If the licenses are IP-based, you can find your login & API security token in Profile section of your CLN account. You need to specify "),a("code",[e._v("login")]),e._v(" and "),a("code",[e._v("api_token")]),e._v(" parameters.")]),e._v(" "),a("p",[e._v("Restart the datadog Agent.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("systemctl restart datadog-agent\n")])])]),a("p",[e._v("You can check your newly installed integration (please do NOT run under python-virtualenv)")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("datadog-agent check kernelcare\n")])])]),a("p",[e._v("After the integration is installed and launched you can login to DataDog dashboard to check metrics.")])])},[],!1,null,null,null);t.default=n.exports}}]);